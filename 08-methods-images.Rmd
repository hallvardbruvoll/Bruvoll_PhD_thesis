# Methods: Fractal image analysis {#images-methods}

fdasdf

## Calculating fractal dimension and lacunarity

-   Box-counting, lit. @mancuso2021, @li2009, @klinkenberg1994

-   Gliding-box algorithms, @allain1991, @hingee2019, @cheng1997, @plotnick1996

-   Caveats:

    -   Fractional box-counting dimension does not equal self-similarity in a simple way

    -   My summary *L* is not equal to the one used in *FracLac* and thus by @far√≠as-pelayo2017

-   Image preparation procedure

In the following, I attempt to address the difficulty of interpreting fractal dimension and lacunarity measures on images by testing the methods on synthetically produced images, designed to isolate relevant variables one by one. The chosen variables are perceived to be of importance specifically in the present context where the images of interest represent architectural features on archaeological settlement plans. While this is not a sufficient analysis for effectively modelling the relative effects that any of these parameters may have on D and L measurements in any image, it allows for an intuitive illustration of the complexity involved in analysing spatial textures. The chosen image variables which are selected here for empirical testing are image size, element count (N), image density, element size distribution, self-similarity/clustering and random noise. The two latter variables are the ones that are of direct interest for the hypothesis which is proposed in this part of the thesis, namely that fractal image analysis may allow for quantification of the degrees of hierarchy and conscious planning in a society evident through the layout of its settlement plans. As is shown below and further discussed in Chapter \@ref(disc-methods), while spatial clustering and noise do have an effect on both fractal dimension and lacunarity measurements #RECHECK THIS#, for most practical purposes these effects tend to be drowned by those induced by other variables like image size and density. The possibility remains that these methods may prove useful for comparisons of settlements of similar size and density only, or by defining a more formal model by which undesired effects of other variables may be factored out #CHECK WORDING HERE AS WELL#.

For the following tests, all images were constructed in R as data tables with x and y coordinates for each element ("house"), rendered with the *ggplot2* package [@wickham2016]. More specifically, houses were represented as a geom_tile() layer with black fill and given height and width, and the background was set to white, while the theme_void() function allowed for removing the axes and grids altogether. With this procedure it was possible to generate incremental change in a single variable on otherwise identical images. However, as some of the variables are inherently connected, full separation was not always possible. All the generated and analysed images are included in #Make Appendix, and the original files, as well as the code for generating them, are available in the #online repository.

## Effects from image size and element size and element count

To test the effect from im

Refer to Figure \@ref(fig:08-IS-HS) below.

(ref:08-IS-HS) Different image sizes and house sizes

```{r 08-IS-HS, fig.cap="(ref:08-IS-HS)"}
load("Results/fig08_IS_HS.RData")
fig08_IS_HS
```

fdsasdf

Then on element count, Figure \@ref(fig:08-N-IS).

(ref:08-N-IS) Element count (N) and image size.

```{r 08-N-IS, fig.cap="(ref:08-N-IS)"}
load("Results/fig08_N_IS.RData")
fig08_N_IS
```

Then to Figure \@ref(fig:08-N-HS).

(ref:08-N-HS) Variable house count (N) and house size, fixed image size and density

```{r 08-N-HS, fig.cap="(ref:08-N-HS)"}
load("Results/fig08_N_HS.RData")
fig08_N_HS
```

Now refer to the beautiful illustration on Figure \@ref(fig:08-N-im).

![Effects from image size, element count and element size on fractal dimension and lacunarity. Density is fixed at xxx for all images](Results/fig08_N_im.pdf){#fig:08-N-im}

Hope this works. Go on.

## Effects from density and size distribution

Relationship between image density (built-up area) and fractal dimension, evaluated in @thomas2007, where they show that these two parameters, under certain conditions (constant observation window, prefactor values close to 1), are exponentially correlated, which is also what I found in my article. They show that observation window size and shape, as well as centroid placement, have little influence on *D*, while they have more influence on density when the pattern is not homogeneous. They do show, however, that images with the same density may have quite much variation in *D*, which is reflected in the layouts. Judging from their examples, more clustered layouts give higher *D* values, while more dispersed or dusty layouts give lower *D*, when density is constant. I ignore the use of prefactor values. According to @thomas2007, density is a crude measure of the overall intensity of the pattern, while fractal dimension is characterises the morphological structure, though it is not directly descriptive.

rasdf. Refer to Figure \@ref(fig:08-dens).

(ref:08-dens) Different image densities

```{r 08-dens, fig.cap="(ref:08-dens)"}
load("Results/fig08_dens.RData")
fig08_dens
```

Then to illustrate, Figure \@ref(fig:08-dens-im).

![Different image densities](Results/fig08_dens_im.pdf){#fig:08-dens-im}

Then to size distributions. See Figure \@ref(fig:08-distr).

(ref:08-distr) Different size distributions of the elements contained in the images

```{r 08-distr, fig.cap="(ref:08-distr)"}
load("Results/fig08_distr.RData")
fig08_distr
```

Then refer to Figure \@ref(fig:08-distr-im).

![Different size distributions](Results/fig08_distr_im.pdf){#fig:08-distr-im}

And go on.

## Quantification of self-similarity and random noise

Now, what's really interesting. Self-similarity as clustering in Figure \@ref(fig:08-clustering).

(ref:08-clustering) Different degrees of spatial clustering and self-similarity

```{r 08-clustering, fig.cap="(ref:08-clustering)"}
load("Results/fig08_clustering.RData")
fig08_clustering
```

See the illustration on Figure \@ref(fig:08-clustering-im).

![Different degrees of clustering and self-similarity](Results/fig08_clustering_im.pdf){#fig:08-clustering-im}

And also random noise, see

(ref:08-noise) Different degrees of random spatial noise

```{r 08-noise, fig.cap="(ref:08-noise)"}
load("Results/fig08_noise.RData")
fig08_noise
```

Then see illustration on Figure \@ref(fig:08-noise).

![Different degrees of random spatial noise](Results/fig08_noise_im.pdf){#fig:08-noise-im}

That's it for the tests. Summarise below.

## Summary of procedure and tests

Just to sum up the different tests:

(ref:08-all) Results from all test series

```{r 08-all, fig.cap="(ref:08-all)"}
load("Results/fig08_all.RData")
fig08_all
```

Though the value ranges of the different tested factors are difficult to compare,... etc.

-   Procedure for archaeological samples, same as in article

-   Procedure for synthetic sample

END Chapter
